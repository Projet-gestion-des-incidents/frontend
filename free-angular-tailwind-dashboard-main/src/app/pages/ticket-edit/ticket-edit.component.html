 

<div  class="max-w-4xl mx-auto space-y-6">
    <div class="mb-6">
    <h1 class="text-2xl font-semibold text-gray-800 dark:text-white/90">
      Modifier le ticket
    </h1>
    <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
      Modifiez les informations du ticket
    </p>
  </div>
    <div class="rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03]">
    <h3 class="mb-4 text-lg font-semibold text-gray-800 dark:text-white/90">
      Informations générales
    </h3>
    <div class="space-y-4">
      <!-- Titre -->
      <div>
        <label class="block mb-2 text-sm font-medium">
          Titre du ticket <span class="text-error-500">*</span>
        </label>
        <input
         [(ngModel)]="ticket.titreTicket"
  name="titreTicket"
          required
          class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-theme-sm text-gray-700 shadow-theme-xs focus:border-brand-300 focus:outline-none dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"
          placeholder="Ex: Panne du serveur de production"
        />
      </div>

      <!-- Description -->
      <div>
        <label class="block mb-2 text-sm font-medium">
          Description <span class="text-error-500">*</span>
        </label>
        <textarea
  [(ngModel)]="ticket.descriptionTicket"
  name="descriptionTicket"
            required
          rows="4"
          class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-theme-sm text-gray-700 shadow-theme-xs focus:border-brand-300 focus:outline-none dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"
          placeholder="Décrivez le ticket en détail..."
        ></textarea>
      </div>
<!-- Priorité -->
<div>
  <label class="block mb-2 text-sm font-medium">Priorité</label>
<select 
            class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-theme-sm text-gray-700 shadow-theme-xs focus:border-brand-300 focus:outline-none dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"
          name="prioriteTicket"
            [(ngModel)]="ticket.prioriteTicket"
>

  <option *ngFor="let p of priorites" [value]="p.value">
    {{ p.label }}
  </option>
</select>
</div>

<!-- Statut -->
<div>
  <label class="block mb-2 text-sm font-medium">Statut</label>
<select 
            class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-theme-sm text-gray-700 shadow-theme-xs focus:border-brand-300 focus:outline-none dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"
 [(ngModel)]="ticket.statutTicket"
  name="statutTicket">
  <option *ngFor="let s of statuts" [value]="s.value">
    {{ s.label }}
  </option></select>
</div>

  <div class="rounded-2xl border border-gray-200 bg-white p-5 dark:border-gray-800 dark:bg-white/[0.03]">
 <!-- Commentaire -->
    <div>
    <label class="block mb-2 text-sm font-medium">Commentaire    </label>
    <textarea
 [(ngModel)]="ticket.commentaireMessage"
  name="commentaireMessage"
  placeholder="Ajouter un commentaire"      
      required
          rows="4"
          class="w-full rounded-lg border border-gray-300 bg-white px-4 py-2.5 text-theme-sm text-gray-700 shadow-theme-xs focus:border-brand-300 focus:outline-none dark:border-gray-700 dark:bg-gray-800 dark:text-gray-400"
        ></textarea>
        </div>
        <br>
         <!-- Piéce Jointe -->

    <div >
      <label  class="block mb-2 text-sm font-medium">Piéce Jointe</label>
<app-file-input-example
  (filesSelected)="onFilesSelected($event)">
</app-file-input-example>     <!-- Affichage des pièces jointes existantes -->
<div *ngIf="ticket.piecesJointes && ticket.piecesJointes.length > 0" class="mt-4">
  <p class="text-sm text-gray-600 mb-2">Pièces jointes existantes :</p>
  <div class="flex flex-wrap gap-4">
    <ng-container *ngFor="let pj of ticket.piecesJointes">
      <!-- Si c'est une image -->
      <img *ngIf="pj.contentType.startsWith('image')" 
           [src]="pj.url" 
           [alt]="pj.nomFichier" 
           class="w-24 h-24 object-cover rounded border"
           (error)="pj.url='https://via.placeholder.com/24'">

      <!-- Si ce n'est pas une image -->
      <a *ngIf="!pj.contentType.startsWith('image')" 
         [href]="pj.url" target="_blank" 
         class="px-2 py-1 bg-gray-100 rounded text-gray-700 hover:bg-gray-200">
        {{ pj.nomFichier }}
      </a>
    </ng-container>
  </div>
</div>
        <!-- Prévisualisation -->
       <!-- <div *ngIf="imagePreview" class="mt-4">
          <p class="text-sm text-gray-600 mb-2">Prévisualisation :</p>
          <img [src]="imagePreview" alt="Preview" class="w-24 h-24 rounded-full object-cover border">
        </div>-->
      </div>
   </div>
    </div>
  </div>

 

  <!-- Boutons d'action -->
   <div class="flex justify-end gap-3">
    <button
      type="button"
      (click)="cancel()"
      class="px-6 py-2.5 text-theme-sm font-medium text-gray-700 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200"
    >
      Annuler
    </button>
    <button
      type="button"
      (click)="save()"
      [disabled]="loading"
      class="inline-flex items-center gap-2 rounded-lg bg-brand-500 px-6 py-2.5 text-theme-sm font-medium text-white shadow-theme-xs hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      <span *ngIf="loading" class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></span>
      {{ loading ? 'Enregistrement...' : 'Enregistrer les modifications' }}
    </button>
  </div>
</div>